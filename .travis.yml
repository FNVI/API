language: php
php:
- '5.6'
- '7.0'
- '7.1'
before_script:
- sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6
- echo "deb [ arch=amd64 ] http://repo.mongodb.org/apt/ubuntu precise/mongodb-org/3.4
  multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.4.list
- sudo apt-get update
- sudo apt-get install -y mongodb-org
- sleep 15
- phpenv config-add travisConfig.ini
- composer self-update
- composer install --prefer-source --no-interaction
script: phpunit
env:
  global:
    - GH_REF: FNVI/mongo
    - secure: aHWOGGDWDPilmBxTi2pCHNk4T5oJlFCESvuZLDrf76jwRmQmBnxJzTmlHjoUSEpzZhyikAzxfMSHx73za2pelMqxz3KzkPeEzT6U7xMyHUHTfHS53jnBvHd+gO94U0vVZiK49G8Kt+SbdCsa082M2ue5pWWDQT7scQAmDMTIwbnd7B2RSJVl6t51+RMxlNLdnZX8UIYMocrGshM0dfHHZfNzlSqMgcIYskXBKIcywY5ZT0En04FG9kwLeMhrhOLgSLpv+ZAuQHOQKTYcttJZqKDefGG+31lVisk5eMX9JRgG7/mUt70F/UP4n08wm/i/1C3InCpMwPCepE4u7LYoZRrK2sC6lTyjNw/3Hf/U8+e6JwvrUEIPO5ITxwk8fV9URZl9OHqc/y0WiFxhrKJbKCt4zuYjg7Qd1pQ0BmSqL9xgHYo/mjOUCzB+BZ9A9XhOeqGJbJkJsxkBHRZP1iSqQ5l3e6tKomsVKslq9YmRzHVjkByOdF1nd2ZQo+wxY+1TP/MnHfnpXeaJ8puNZ+cJwE7nfckZ7HrQlbvLyeAHhNd8XrEZqSwFnc9BOpQ5b6TjDeZGuf/aXj8e5XQXs8RiHZQOvSPkOGj+uSZTSY2JPmNbQnjbWpPbrbsBMjE+NRygmQXB1d9DJr80ow3D8smFbMnZBdG0zr2sapXrtSLq1Ps=
after_success:
  - if  [ $TRAVIS_PHP_VERSION = '5.6' ] && [ $TRAVIS_BRANCH = 'master' ] && [ $TRAVIS_PULL_REQUEST = 'false' ]; then sh generate-api.sh; fi